<!-- Content pagina -->
<div class="container-fluid">
  <div class="page-header">
    <h1 class="text-titles"><i class="zmdi zmdi-money-box zmdi-hc-fw"></i>Registro<small>FCT</small></h1>
  </div>
  <p class="lead">Rellenando el siguiente formulario podremos crear una FCT para un alumno de 2º. 
   Este proceso solo podrá realizarlo el administrador.</p>
</div>
<div class="container-fluid">
  <div class="row">
    <div class="col-xs-12">
      <ul class="nav nav-tabs" style="margin-bottom: 15px;">
        <li class="active"><a href="/registrar_FCT" data-toggle="tab">Nuevo</a></li>
        <li><a href="/alumnos_FCT">Listado de Alumnos en FCT</a></li>
      </ul>
      <div id="myTabContent" class="tab-content">
        <div class="tab-pane fade active in" id="new">
          <div class="container-fluid">
            <div class="row">
              <div class="col-xs-12 col-md-10 col-md-offset-1">
                <form method="post">
                   <div class="form-group">
					      <label class="control-label">Seleccione un Alumno de 2ºFP</label>
					      <select class="form-control" name="alumno" id="alumno" >
                          {{#each alumnos as | Alumnos |}}
                          <option value="{{Alumnos.name}}">{{Alumnos.name}} </option>
                          {{/each}}
                     </select>
                  </div>
                  <div class="form-group">
					      <label  class="control-label">Eliga su empresa</label>
					      <select class="form-control" name="empresa" id="empresa" >
                          {{#each empresas as | Empresas |}}
                          <option value="{{Empresas.name}}"> {{Empresas.name}} </option>
                          {{/each}}
                     </select>
                  </div>
                  <div class="form-group label-floating">
                    <label class="control-label">Tutor laboral en la empresa</label>
                    <input class="form-control" name="tutor_practicas" id="tutor_practicas" type="text" />
                  </div>
                  <div class="form-group label-floating">
                    <label class="control-label">Tutor profesor </label>
                    <input class="form-control" name="tutor_profesor" id="tutor_profesor" type="text" />
                  </div>
				       <div class="form-group label-floating">
					          <label class="control-label">Trimestre en el que se realizaran las practicas</label>
				          <select class="form-control" name="trimestre" id="trimestre">
											<option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
										</select>
					    </div>

              <div class="form-group label-floating">
					          <label class="control-label">Numero de horas diaras</label>
				          <select class="form-control" name="horas" id="horas">
											<option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
										</select>
					    </div>

              <div class="form-group label-floating">
                    <label class="control-label">Cargo que tendra en la empresa</label>
                    <input class="form-control" name="cargo" id="cargo" type="text" />
              </div>

                  <div class="form-group label-floating">
                    <label>Inicio de las practicas</label>
                    <input class="form-control" name="inicio_FCT" type="date" />
                  </div>
                  <div class="form-group label-floating">
                    <label>Final de las practicas</label>
                    <input class="form-control" name="final_FCT" type="date" />
                  </div>
                  <p class="text-center">
                    <button class="btn btn-info btn-raised btn-sm"><i class="zmdi zmdi-floppy"></i>Save</button>
                  </p>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--SCRIPT PARA LOCALIDAD Y PROVINCIA-->

<script>

	(async () => {
            const province = document.querySelector("#province");
            const city = document.querySelector("#city");
            const responseProvinces = await fetch('/select_province');

            const provinces = await responseProvinces.json();
            provinces.map(p => {
                let opt = document.createElement('option');
                opt.value = p._id;
                opt.innerText = p.showName;
                province.appendChild(opt);
            })
            province.addEventListener("change", async () => {
                const currentProvince = province.value;
                let responseCities = await fetch(`/select_city/${currentProvince}`);
                currentCities = await responseCities.json();
                
                if(!currentCities) return alert('No existe esa provincia!');
                
                city.removeAttribute('disabled');
                city.innerHTML = '';
                let disabledOptCity = document.createElement('option');
                disabledOptCity.innerHTML = '---';
                disabledOptCity.setAttribute('disabled', true);
                disabledOptCity.setAttribute('selected', true);
                city.appendChild(disabledOptCity);
                currentCities.map( c => {
                    let opt = document.createElement('option');
                    opt.value = c._id;
                    opt.innerText = c.name;
                    console.log(c);
                    city.appendChild(opt);
                })
            })
        })()
</script> 
